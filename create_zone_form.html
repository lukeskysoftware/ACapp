<!DOCTYPE html>
<html>
<head>
    <title>Create Zone</title>
    <?php include 'config.php'; ?>
    <?php include 'menu.php'; ?>
    
    <script async
        src="https://maps.googleapis.com/maps/api/js?key=<?php echo GOOGLE_MAPS_API_KEY; ?>&libraries=places&language=it">
    </script>
</head>
<body>
    <h2>Create Zone</h2>
    <form action="create_zone.php" method="post">
        <label for="name">Zone Name:</label><br>
        <input type="text" id="name" name="name" required><br><br>
        
        <label for="address">Zone Address:</label><br>
        <input type="text" id="address" name="address" required><br><br>
        
        <label for="radius_km">Radius (km):</label><br>
        <input type="number" id="radius_km" name="radius_km" required><br><br>
        
        <label for="days">Days of the Week:</label><br>
        <select id="days" name="days[]" multiple required>
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
            <option value="Sunday">Sunday</option>
        </select><br><br>

        <label for="start_time">Start Time:</label><br>
        <input type="time" id="start_time" name="start_time" required><br><br>

        <label for="end_time">End Time:</label><br>
        <input type="time" id="end_time" name="end_time" required><br><br>

        <label for="duration">Appointment Duration (minutes):</label><br>
        <input type="number" id="duration" name="duration" required><br><br>

        <input type="submit" value="Create Zone">
    </form>

    <script>
        function initAutocomplete() {
            var input = document.getElementById('address');
            var options = {
                types: ['geocode'],
                strictBounds: true, 
                bounds: {
                    north: 42.1, 
                    south: 40.8, 
                    west: 11.5, 
                    east: 13.0 
                }
            };
            var autocomplete = new google.maps.places.Autocomplete(input, options);

            autocomplete.addListener('place_changed', function() {
                var place = autocomplete.getPlace();
                if (place.address_components) {
                    for (var i = 0; i < place.address_components.length; i++) {
                        var addressType = place.address_components[i].types[0];
                        if (addressType === 'locality') {
                            document.getElementById('city').value = place.address_components[i].long_name;
                            document.getElementById('temp_city').value = place.address_components[i].long_name;
                        } else if (addressType === 'administrative_area_level_1') {
                            document.getElementById('province').value = place.address_components[i].short_name;
                            document.getElementById('temp_province').value = place.address_components[i].short_name;
                        } else if (addressType === 'postal_code') {
                            document.getElementById('zip').value = place.address_components[i].long_name;
                            document.getElementById('temp_zip').value = place.address_components[i].long_name;
                        }
                    }
                }
                document.getElementById('temp_latitude').value = place.geometry.location.lat();
                document.getElementById('temp_longitude').value = place.geometry.location.lng();
            });
        }
        window.addEventListener('load', initAutocomplete);
    </script>
</body>
</html>
